{"version":3,"file":"users-table.js","mappings":"mBAAAA,OAAOC,SAASC,iBAAiB,oBAAoB,KACjD,MAAMC,EAAQF,SAASG,cAAc,wBAC/BC,EAAOF,EAAMG,iBAAiB,mBAC9BC,EAAMC,MAAMC,KAAKJ,GAAMK,KAAIC,GACtBA,EAAIC,aAAa,MAAMC,QAAQ,QAAS,MAEnD,IAAKN,EAAIO,OAAQ,OAEjB,MAAMC,EAAOZ,EAAMC,cAAc,UAC3BY,EAAUf,SAASgB,cAAc,QACvCD,EAAQE,UAAUC,IAAI,UAAW,aACjCH,EAAQI,MAAMC,SAAW,WACzBL,EAAQI,MAAME,UAAY,yBAC1BP,EAAKQ,QAAQP,GAEbQ,MACIxB,OAAOyB,kBAAkBC,QAAQ,mDAAqDnB,EAAIoB,KAAK,MACjGC,MACEC,GAAYA,EAASC,SACvBF,MACGE,IACG,IAAK,MAAMC,KAAUD,EAAM,CACvB,MAAME,EAAO7B,EAAMC,cAAc,eAAe2B,EAAO,0BACvD,GAAGC,EAAK5B,cAAc,KAClB4B,EAAK5B,cAAc,wBAAwB6B,YAAcC,OAAOJ,EAAKC,SAClE,GAAGD,EAAKC,GAAU,EAAE,CACvB,MAAMI,EAAIlC,SAASgB,cAAc,KACjCkB,EAAEC,KAAOpC,OAAOyB,kBAAkBY,SAAS,WAAWN,EACtDI,EAAEG,UAAYJ,OAAOJ,EAAKC,IAC1BC,EAAKO,UAAY,GACjBP,EAAKQ,OAAOL,EAChB,CACJ,KAENM,SACE,KACIC,YAAW,KACP1B,EAAQ2B,QAAQ,GACjB,IAAK,GAEf,G","sources":["webpack://additional-authors/./src/users-table.ts"],"sourcesContent":["window.document.addEventListener(\"DOMContentLoaded\", () => {\n    const table = document.querySelector(\".wp-list-table.users\")\n    const rows = table.querySelectorAll(\"tr[id^='user-']\");\n    const ids = Array.from(rows).map(row => {\n        return row.getAttribute(\"id\").replace(\"user-\", \"\");\n    });\n    if (!ids.length) return;\n\n    const head = table.querySelector(\"#posts\");\n    const spinner = document.createElement(\"span\");\n    spinner.classList.add(\"spinner\", \"is-active\");\n    spinner.style.position = \"absolute\";\n    spinner.style.transform = \"translate(-34px, -4px)\";\n    head.prepend(spinner);\n\n    fetch(\n        window.AdditionalAuthors.ajaxUrl+\"?action=additional_authors_count_posts&user_ids=\" + ids.join(\",\")\n    ).then(\n        response => response.json()\n    ).then(\n        (json: Record<string, number>) => {\n            for (const userId in json) {\n                const item = table.querySelector(\"tr[id='user-\"+userId+\"'] td.column-posts.num\");\n                if(item.querySelector(\"a\")){\n                    item.querySelector(\"a > span:first-child\").textContent = String(json[userId]);\n                } else if(json[userId] > 0){\n                    const a = document.createElement(\"a\");\n                    a.href = window.AdditionalAuthors.postsUrl+\"?author=\"+userId;\n                    a.innerText = String(json[userId]);\n                    item.innerHTML = \"\";\n                    item.append(a);\n                }\n            }\n        }\n    ).finally(\n        ()=> {\n            setTimeout(()=>{\n                spinner.remove();\n            }, 1000)\n        }\n    );\n\n});\n\nexport {}\n\ndeclare global {\n    interface Window {\n        AdditionalAuthors: {\n            postsUrl: string\n            ajaxUrl: string\n        }\n    }\n}\n"],"names":["window","document","addEventListener","table","querySelector","rows","querySelectorAll","ids","Array","from","map","row","getAttribute","replace","length","head","spinner","createElement","classList","add","style","position","transform","prepend","fetch","AdditionalAuthors","ajaxUrl","join","then","response","json","userId","item","textContent","String","a","href","postsUrl","innerText","innerHTML","append","finally","setTimeout","remove"],"sourceRoot":""}